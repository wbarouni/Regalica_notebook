{"ast":null,"code":"import _asyncToGenerator from \"/home/ubuntu/Regalica_notebook/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/rag.service\";\nimport * as i2 from \"../core/services/viewer.service\";\nimport * as i3 from \"../core/services/app-config.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nconst _c0 = [\"messagesContainer\"];\nconst _c1 = [\"queryInput\"];\nfunction ChatPanelComponent_div_16_div_8_button_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 38);\n    i0.ɵɵlistener(\"click\", function ChatPanelComponent_div_16_div_8_button_4_Template_button_click_0_listener() {\n      const question_r3 = i0.ɵɵrestoreView(_r2).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r3.useExampleQuestion(question_r3));\n    });\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(1, \"svg\", 10);\n    i0.ɵɵelement(2, \"path\", 39);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const question_r3 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", question_r3, \" \");\n  }\n}\nfunction ChatPanelComponent_div_16_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 34)(1, \"h4\", 35);\n    i0.ɵɵtext(2, \"Try asking:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 36);\n    i0.ɵɵtemplate(4, ChatPanelComponent_div_16_div_8_button_4_Template, 4, 1, \"button\", 37);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.exampleQuestions);\n  }\n}\nfunction ChatPanelComponent_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27)(1, \"div\", 28);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(2, \"svg\", 29);\n    i0.ɵɵelement(3, \"path\", 30);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(4, \"h3\", 31);\n    i0.ɵɵtext(5, \"Welcome to Regalica Notebook\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\", 32);\n    i0.ɵɵtext(7, \" Ask questions about your uploaded documents. I'll provide answers with precise citations and sources. \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(8, ChatPanelComponent_div_16_div_8_Template, 5, 1, \"div\", 33);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.exampleQuestions.length > 0);\n  }\n}\nfunction ChatPanelComponent_div_17_div_1_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 46)(1, \"div\", 47)(2, \"div\", 48);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 49);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\", 50);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(7, \"svg\", 6);\n    i0.ɵɵelement(8, \"path\", 51);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const message_r5 = i0.ɵɵnextContext().$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(message_r5.content);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r3.formatTime(message_r5.timestamp), \" \");\n  }\n}\nfunction ChatPanelComponent_div_17_div_1_div_2_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 64)(1, \"div\", 65);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(2, \"svg\", 66);\n    i0.ɵɵelement(3, \"path\", 67);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(4, \"div\", 68)(5, \"h4\");\n    i0.ɵɵtext(6, \"No relevant information found\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"p\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(4);\n    i0.ɵɵadvance(8);\n    i0.ɵɵtextInterpolate(ctx_r3.getNoAnswerExplanation());\n  }\n}\nfunction ChatPanelComponent_div_17_div_1_div_2_div_6_div_2_button_4_span_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 80);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const source_r8 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" Page \", source_r8.page, \" \");\n  }\n}\nfunction ChatPanelComponent_div_17_div_1_div_2_div_6_div_2_button_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 75);\n    i0.ɵɵlistener(\"click\", function ChatPanelComponent_div_17_div_1_div_2_div_6_div_2_button_4_Template_button_click_0_listener() {\n      const source_r8 = i0.ɵɵrestoreView(_r7).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext(6);\n      return i0.ɵɵresetView(ctx_r3.onCitationClick(source_r8));\n    });\n    i0.ɵɵelementStart(1, \"div\", 76)(2, \"span\", 77);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, ChatPanelComponent_div_17_div_1_div_2_div_6_div_2_button_4_span_4_Template, 2, 1, \"span\", 78);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 79);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const source_r8 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(6);\n    i0.ɵɵclassMap(\"confidence-\" + ctx_r3.getConfidenceLevel(source_r8.confidence));\n    i0.ɵɵproperty(\"title\", \"Confidence: \" + ctx_r3.formatConfidence(source_r8.confidence));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(source_r8.title);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", source_r8.page);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r3.formatConfidence(source_r8.confidence), \" \");\n  }\n}\nfunction ChatPanelComponent_div_17_div_1_div_2_div_6_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 71)(1, \"h4\", 72);\n    i0.ɵɵtext(2, \"Sources:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 73);\n    i0.ɵɵtemplate(4, ChatPanelComponent_div_17_div_1_div_2_div_6_div_2_button_4_Template, 7, 6, \"button\", 74);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const message_r5 = i0.ɵɵnextContext(3).$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", message_r5.sources)(\"ngForTrackBy\", ctx_r3.trackBySourceId);\n  }\n}\nfunction ChatPanelComponent_div_17_div_1_div_2_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 48);\n    i0.ɵɵelement(1, \"div\", 69);\n    i0.ɵɵtemplate(2, ChatPanelComponent_div_17_div_1_div_2_div_6_div_2_Template, 5, 2, \"div\", 70);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const message_r5 = i0.ɵɵnextContext(2).$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"innerHTML\", ctx_r3.formatMessageContent(message_r5.content), i0.ɵɵsanitizeHtml);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", message_r5.sources && message_r5.sources.length > 0);\n  }\n}\nfunction ChatPanelComponent_div_17_div_1_div_2_span_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 81);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const message_r5 = i0.ɵɵnextContext(2).$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r3.formatProcessingTime(message_r5.processingTimeMs), \" \");\n  }\n}\nfunction ChatPanelComponent_div_17_div_1_div_2_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 82);\n    i0.ɵɵelement(1, \"div\", 83);\n    i0.ɵɵelementStart(2, \"span\", 84);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const message_r5 = i0.ɵɵnextContext(2).$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassMap(ctx_r3.getConfidenceClass(message_r5.confidence));\n    i0.ɵɵadvance();\n    i0.ɵɵstyleProp(\"width\", message_r5.confidence * 100, \"%\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r3.formatConfidence(message_r5.confidence), \" confidence \");\n  }\n}\nfunction ChatPanelComponent_div_17_div_1_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 52)(1, \"div\", 50);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(2, \"svg\", 6);\n    i0.ɵɵelement(3, \"path\", 30);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(4, \"div\", 47);\n    i0.ɵɵtemplate(5, ChatPanelComponent_div_17_div_1_div_2_div_5_Template, 9, 1, \"div\", 53)(6, ChatPanelComponent_div_17_div_1_div_2_div_6_Template, 3, 2, \"div\", 54);\n    i0.ɵɵelementStart(7, \"div\", 55)(8, \"div\", 56)(9, \"span\", 49);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(11, ChatPanelComponent_div_17_div_1_div_2_span_11_Template, 2, 1, \"span\", 57);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(12, ChatPanelComponent_div_17_div_1_div_2_div_12_Template, 4, 5, \"div\", 58);\n    i0.ɵɵelementStart(13, \"div\", 59)(14, \"button\", 60);\n    i0.ɵɵlistener(\"click\", function ChatPanelComponent_div_17_div_1_div_2_Template_button_click_14_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const message_r5 = i0.ɵɵnextContext().$implicit;\n      const ctx_r3 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r3.copyMessage(message_r5));\n    });\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(15, \"svg\", 10);\n    i0.ɵɵelement(16, \"path\", 61);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(17, \"button\", 62);\n    i0.ɵɵlistener(\"click\", function ChatPanelComponent_div_17_div_1_div_2_Template_button_click_17_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const message_r5 = i0.ɵɵnextContext().$implicit;\n      const ctx_r3 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r3.improveQuestion(message_r5));\n    });\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(18, \"svg\", 10);\n    i0.ɵɵelement(19, \"path\", 63);\n    i0.ɵɵelementEnd()()()()()();\n  }\n  if (rf & 2) {\n    const message_r5 = i0.ɵɵnextContext().$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.isNoAnswer(message_r5));\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", !ctx_r3.isNoAnswer(message_r5));\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r3.formatTime(message_r5.timestamp), \" \");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", message_r5.processingTimeMs);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", message_r5.confidence !== undefined);\n  }\n}\nfunction ChatPanelComponent_div_17_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 43);\n    i0.ɵɵtemplate(1, ChatPanelComponent_div_17_div_1_div_1_Template, 9, 2, \"div\", 44)(2, ChatPanelComponent_div_17_div_1_div_2_Template, 20, 5, \"div\", 45);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const message_r5 = ctx.$implicit;\n    i0.ɵɵclassMap(\"message-\" + message_r5.role);\n    i0.ɵɵattribute(\"data-testid\", \"message-\" + message_r5.role);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", message_r5.role === \"user\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", message_r5.role === \"assistant\");\n  }\n}\nfunction ChatPanelComponent_div_17_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 85)(1, \"div\", 50);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(2, \"svg\", 6);\n    i0.ɵɵelement(3, \"path\", 30);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(4, \"div\", 86)(5, \"div\", 87)(6, \"div\", 88);\n    i0.ɵɵelement(7, \"span\")(8, \"span\")(9, \"span\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"span\", 89);\n    i0.ɵɵtext(11, \"Thinking...\");\n    i0.ɵɵelementEnd()()()();\n  }\n}\nfunction ChatPanelComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 40);\n    i0.ɵɵtemplate(1, ChatPanelComponent_div_17_div_1_Template, 3, 5, \"div\", 41)(2, ChatPanelComponent_div_17_div_2_Template, 12, 0, \"div\", 42);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.messages)(\"ngForTrackBy\", ctx_r3.trackByMessageId);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.isStreaming);\n  }\n}\nfunction ChatPanelComponent__svg_svg_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(0, \"svg\", 6);\n    i0.ɵɵelement(1, \"path\", 90);\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ChatPanelComponent_div_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\", 91);\n  }\n}\nfunction ChatPanelComponent_div_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 92);\n    i0.ɵɵelement(1, \"span\", 93);\n    i0.ɵɵelementStart(2, \"span\", 94);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵclassMap(\"status-\" + ctx_r3.connectionStatus);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r3.getConnectionStatusText());\n  }\n}\nexport let ChatPanelComponent = /*#__PURE__*/(() => {\n  class ChatPanelComponent {\n    constructor(ragService, viewerService, appConfig) {\n      this.ragService = ragService;\n      this.viewerService = viewerService;\n      this.appConfig = appConfig;\n      this.messages = [];\n      this.currentQuery = '';\n      this.isStreaming = false;\n      this.connectionStatus = 'connected';\n      this.destroy$ = new Subject();\n      this.shouldScrollToBottom = false;\n      // Exemples de questions\n      this.exampleQuestions = [\"What are the main topics covered in the documents?\", \"Can you summarize the key findings?\", \"What are the most important recommendations?\", \"Are there any specific conclusions mentioned?\"];\n    }\n    ngOnInit() {\n      this.setupSubscriptions();\n      this.loadChatHistory();\n    }\n    ngOnDestroy() {\n      this.destroy$.next();\n      this.destroy$.complete();\n    }\n    ngAfterViewChecked() {\n      if (this.shouldScrollToBottom) {\n        this.scrollToBottom();\n        this.shouldScrollToBottom = false;\n      }\n    }\n    /**\n     * Configure les abonnements aux services\n     */\n    setupSubscriptions() {\n      // Messages\n      this.ragService.messages$.pipe(takeUntil(this.destroy$)).subscribe(messages => {\n        this.messages = messages;\n        this.shouldScrollToBottom = true;\n      });\n      // État de streaming\n      this.ragService.loading$.pipe(takeUntil(this.destroy$)).subscribe(loading => {\n        this.isStreaming = loading;\n        if (loading) {\n          this.shouldScrollToBottom = true;\n        }\n      });\n    }\n    /**\n     * Charge l'historique du chat\n     */\n    loadChatHistory() {\n      // L'historique est géré par le RagService\n      // Cette méthode peut être étendue pour charger depuis le localStorage\n    }\n    /**\n     * Envoie une question\n     */\n    sendQuery() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        const query = _this.currentQuery.trim();\n        if (!query || _this.isStreaming) {\n          return;\n        }\n        // Vider le champ de saisie\n        _this.currentQuery = '';\n        try {\n          yield _this.ragService.chatWithRag(query);\n        } catch (error) {\n          console.error('Error sending query:', error);\n          _this.connectionStatus = 'disconnected';\n          // Réessayer la connexion après un délai\n          setTimeout(() => {\n            _this.connectionStatus = 'connected';\n          }, 3000);\n        }\n      })();\n    }\n    /**\n     * Utilise une question d'exemple\n     */\n    useExampleQuestion(question) {\n      this.currentQuery = question;\n      this.focusInput();\n    }\n    /**\n     * Gère l'appui sur les touches\n     */\n    onKeyPress(event) {\n      if (event.key === 'Enter' && !event.shiftKey) {\n        event.preventDefault();\n        this.sendQuery();\n      }\n    }\n    /**\n     * Efface l'historique des messages\n     */\n    clearChat() {\n      if (confirm('Are you sure you want to clear the chat history?')) {\n        this.ragService.clearMessages();\n      }\n    }\n    /**\n     * Exporte le chat\n     */\n    exportChat() {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        if (_this2.messages.length === 0) return;\n        try {\n          const chatData = _this2.messages.map(msg => ({\n            role: msg.role,\n            content: msg.content,\n            timestamp: msg.timestamp.toISOString(),\n            sources: msg.sources || [],\n            confidence: msg.confidence,\n            processingTimeMs: msg.processingTimeMs\n          }));\n          const blob = new Blob([JSON.stringify(chatData, null, 2)], {\n            type: 'application/json'\n          });\n          const url = URL.createObjectURL(blob);\n          const a = document.createElement('a');\n          a.href = url;\n          a.download = `regalica-chat-${new Date().toISOString().split('T')[0]}.json`;\n          document.body.appendChild(a);\n          a.click();\n          document.body.removeChild(a);\n          URL.revokeObjectURL(url);\n        } catch (error) {\n          console.error('Error exporting chat:', error);\n        }\n      })();\n    }\n    /**\n     * Clique sur une citation\n     */\n    onCitationClick(source) {\n      this.viewerService.scrollToSpan({\n        docId: source.id,\n        page: source.page,\n        spanStart: source.spanStart,\n        spanEnd: source.spanEnd,\n        chunkId: source.chunkId\n      });\n    }\n    /**\n     * Copie un message dans le presse-papiers\n     */\n    copyMessage(message) {\n      return _asyncToGenerator(function* () {\n        try {\n          yield navigator.clipboard.writeText(message.content);\n          // TODO: Afficher une notification de succès\n        } catch (error) {\n          console.error('Error copying message:', error);\n        }\n      })();\n    }\n    /**\n     * Améliore une question\n     */\n    improveQuestion(message) {\n      // Trouver la question utilisateur correspondante\n      const messageIndex = this.messages.indexOf(message);\n      if (messageIndex > 0) {\n        const userMessage = this.messages[messageIndex - 1];\n        if (userMessage.role === 'user') {\n          this.currentQuery = `Please provide more details about: ${userMessage.content}`;\n          this.focusInput();\n        }\n      }\n    }\n    /**\n     * Formate le contenu d'un message (support basique du markdown)\n     */\n    formatMessageContent(content) {\n      return content.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>').replace(/\\*(.*?)\\*/g, '<em>$1</em>').replace(/`(.*?)`/g, '<code>$1</code>').replace(/\\n/g, '<br>');\n    }\n    /**\n     * Formate l'heure\n     */\n    formatTime(timestamp) {\n      return timestamp.toLocaleTimeString([], {\n        hour: '2-digit',\n        minute: '2-digit'\n      });\n    }\n    /**\n     * Formate le temps de traitement\n     */\n    formatProcessingTime(timeMs) {\n      if (timeMs < 1000) {\n        return `${Math.round(timeMs)}ms`;\n      } else {\n        return `${(timeMs / 1000).toFixed(1)}s`;\n      }\n    }\n    /**\n     * Formate le score de confiance\n     */\n    formatConfidence(confidence) {\n      return `${Math.round(confidence * 100)}%`;\n    }\n    /**\n     * Obtient le niveau de confiance\n     */\n    getConfidenceLevel(confidence) {\n      if (confidence >= 0.8) return 'high';\n      if (confidence >= 0.6) return 'medium';\n      return 'low';\n    }\n    /**\n     * Obtient la classe CSS pour le score de confiance\n     */\n    getConfidenceClass(confidence) {\n      return `confidence-${this.getConfidenceLevel(confidence)}`;\n    }\n    /**\n     * Vérifie si un message est une réponse \"NO_ANSWER\"\n     */\n    isNoAnswer(message) {\n      return message.role === 'assistant' && message.content.trim() === 'NO_ANSWER';\n    }\n    /**\n     * Obtient un message d'explication pour NO_ANSWER\n     */\n    getNoAnswerExplanation() {\n      return \"I couldn't find relevant information in the uploaded documents to answer your question. Try rephrasing your question or asking about a different topic.\";\n    }\n    /**\n     * Obtient le texte du statut de connexion\n     */\n    getConnectionStatusText() {\n      switch (this.connectionStatus) {\n        case 'connecting':\n          return 'Connecting...';\n        case 'disconnected':\n          return 'Connection lost';\n        default:\n          return 'Connected';\n      }\n    }\n    /**\n     * TrackBy pour optimiser le rendu des messages\n     */\n    trackByMessageId(index, message) {\n      return message.id;\n    }\n    /**\n     * TrackBy pour optimiser le rendu des sources\n     */\n    trackBySourceId(index, source) {\n      return source.id + source.spanStart + source.spanEnd;\n    }\n    /**\n     * Fait défiler vers le bas\n     */\n    scrollToBottom() {\n      try {\n        if (this.messagesContainer) {\n          const element = this.messagesContainer.nativeElement;\n          element.scrollTop = element.scrollHeight;\n        }\n      } catch (error) {\n        console.error('Error scrolling to bottom:', error);\n      }\n    }\n    /**\n     * Met le focus sur le champ de saisie\n     */\n    focusInput() {\n      setTimeout(() => {\n        if (this.queryInput) {\n          this.queryInput.nativeElement.focus();\n        }\n      }, 100);\n    }\n    static {\n      this.ɵfac = function ChatPanelComponent_Factory(t) {\n        return new (t || ChatPanelComponent)(i0.ɵɵdirectiveInject(i1.RagService), i0.ɵɵdirectiveInject(i2.ViewerService), i0.ɵɵdirectiveInject(i3.AppConfigService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: ChatPanelComponent,\n        selectors: [[\"app-chat-panel\"]],\n        viewQuery: function ChatPanelComponent_Query(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵviewQuery(_c0, 5);\n            i0.ɵɵviewQuery(_c1, 5);\n          }\n          if (rf & 2) {\n            let _t;\n            i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.messagesContainer = _t.first);\n            i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.queryInput = _t.first);\n          }\n        },\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 36,\n        vars: 14,\n        consts: [[\"messagesContainer\", \"\"], [\"queryInput\", \"\"], [1, \"chat-panel\"], [1, \"chat-header\"], [1, \"header-content\"], [1, \"chat-title\"], [\"fill\", \"none\", \"stroke\", \"currentColor\", \"viewBox\", \"0 0 24 24\", 1, \"w-5\", \"h-5\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\"], [1, \"header-actions\"], [\"title\", \"Clear chat history\", 1, \"header-btn\", 3, \"click\", \"disabled\"], [\"fill\", \"none\", \"stroke\", \"currentColor\", \"viewBox\", \"0 0 24 24\", 1, \"w-4\", \"h-4\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1-1H8a1 1 0 00-1 1v3M4 7h16\"], [\"title\", \"Export chat\", 1, \"header-btn\", 3, \"click\", \"disabled\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"], [1, \"messages-container\"], [\"class\", \"welcome-state\", 4, \"ngIf\"], [\"class\", \"messages-list\", 4, \"ngIf\"], [1, \"input-area\"], [1, \"input-container\"], [\"placeholder\", \"Ask a question about your documents...\", \"rows\", \"2\", \"data-testid\", \"query-input\", 1, \"query-input\", 3, \"ngModelChange\", \"keydown\", \"ngModel\", \"disabled\"], [\"data-testid\", \"send-btn\", 1, \"send-btn\", 3, \"click\", \"disabled\"], [\"class\", \"w-5 h-5\", \"fill\", \"none\", \"stroke\", \"currentColor\", \"viewBox\", \"0 0 24 24\", 4, \"ngIf\"], [\"class\", \"loading-spinner\", 4, \"ngIf\"], [1, \"input-footer\"], [1, \"input-hints\"], [1, \"hint\"], [\"class\", \"input-status\", 4, \"ngIf\"], [1, \"welcome-state\"], [1, \"welcome-icon\"], [\"fill\", \"none\", \"stroke\", \"currentColor\", \"viewBox\", \"0 0 24 24\", 1, \"w-16\", \"h-16\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M9.663 17h4.673M12 3v1m6.364-.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\"], [1, \"welcome-title\"], [1, \"welcome-description\"], [\"class\", \"example-questions\", 4, \"ngIf\"], [1, \"example-questions\"], [1, \"examples-title\"], [1, \"examples-grid\"], [\"class\", \"example-btn\", 3, \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"example-btn\", 3, \"click\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"], [1, \"messages-list\"], [\"class\", \"message-wrapper\", 3, \"class\", 4, \"ngFor\", \"ngForOf\", \"ngForTrackBy\"], [\"class\", \"streaming-indicator\", 4, \"ngIf\"], [1, \"message-wrapper\"], [\"class\", \"user-message\", 4, \"ngIf\"], [\"class\", \"assistant-message\", 4, \"ngIf\"], [1, \"user-message\"], [1, \"message-bubble\"], [1, \"message-content\"], [1, \"message-timestamp\"], [1, \"message-avatar\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\"], [1, \"assistant-message\"], [\"class\", \"no-answer-state\", 4, \"ngIf\"], [\"class\", \"message-content\", 4, \"ngIf\"], [1, \"message-footer\"], [1, \"message-meta\"], [\"class\", \"processing-time\", 4, \"ngIf\"], [\"class\", \"confidence-bar\", 3, \"class\", 4, \"ngIf\"], [1, \"message-actions\"], [\"title\", \"Copy message\", 1, \"action-btn\", 3, \"click\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\"], [\"title\", \"Improve this question\", 1, \"action-btn\", 3, \"click\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M13 10V3L4 14h7v7l9-11h-7z\"], [1, \"no-answer-state\"], [1, \"no-answer-icon\"], [\"fill\", \"none\", \"stroke\", \"currentColor\", \"viewBox\", \"0 0 24 24\", 1, \"w-6\", \"h-6\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"], [1, \"no-answer-content\"], [1, \"answer-text\", 3, \"innerHTML\"], [\"class\", \"message-sources\", 4, \"ngIf\"], [1, \"message-sources\"], [1, \"sources-title\"], [1, \"sources-list\"], [\"class\", \"source-citation\", 3, \"class\", \"title\", \"click\", 4, \"ngFor\", \"ngForOf\", \"ngForTrackBy\"], [1, \"source-citation\", 3, \"click\", \"title\"], [1, \"citation-content\"], [1, \"citation-title\"], [\"class\", \"citation-location\", 4, \"ngIf\"], [1, \"citation-confidence\"], [1, \"citation-location\"], [1, \"processing-time\"], [1, \"confidence-bar\"], [1, \"confidence-fill\"], [1, \"confidence-label\"], [1, \"streaming-indicator\"], [1, \"streaming-bubble\"], [1, \"streaming-content\"], [1, \"typing-dots\"], [1, \"streaming-text\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M12 19l9 2-9-18-9 18 9-2zm0 0v-8\"], [1, \"loading-spinner\"], [1, \"input-status\"], [1, \"status-indicator\"], [1, \"status-text\"]],\n        template: function ChatPanelComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            const _r1 = i0.ɵɵgetCurrentView();\n            i0.ɵɵelementStart(0, \"div\", 2)(1, \"div\", 3)(2, \"div\", 4)(3, \"h2\", 5);\n            i0.ɵɵnamespaceSVG();\n            i0.ɵɵelementStart(4, \"svg\", 6);\n            i0.ɵɵelement(5, \"path\", 7);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(6, \" Chat Assistant \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵnamespaceHTML();\n            i0.ɵɵelementStart(7, \"div\", 8)(8, \"button\", 9);\n            i0.ɵɵlistener(\"click\", function ChatPanelComponent_Template_button_click_8_listener() {\n              i0.ɵɵrestoreView(_r1);\n              return i0.ɵɵresetView(ctx.clearChat());\n            });\n            i0.ɵɵnamespaceSVG();\n            i0.ɵɵelementStart(9, \"svg\", 10);\n            i0.ɵɵelement(10, \"path\", 11);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵnamespaceHTML();\n            i0.ɵɵelementStart(11, \"button\", 12);\n            i0.ɵɵlistener(\"click\", function ChatPanelComponent_Template_button_click_11_listener() {\n              i0.ɵɵrestoreView(_r1);\n              return i0.ɵɵresetView(ctx.exportChat());\n            });\n            i0.ɵɵnamespaceSVG();\n            i0.ɵɵelementStart(12, \"svg\", 10);\n            i0.ɵɵelement(13, \"path\", 13);\n            i0.ɵɵelementEnd()()()()();\n            i0.ɵɵnamespaceHTML();\n            i0.ɵɵelementStart(14, \"div\", 14, 0);\n            i0.ɵɵtemplate(16, ChatPanelComponent_div_16_Template, 9, 1, \"div\", 15)(17, ChatPanelComponent_div_17_Template, 3, 3, \"div\", 16);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(18, \"div\", 17)(19, \"div\", 18)(20, \"textarea\", 19, 1);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function ChatPanelComponent_Template_textarea_ngModelChange_20_listener($event) {\n              i0.ɵɵrestoreView(_r1);\n              i0.ɵɵtwoWayBindingSet(ctx.currentQuery, $event) || (ctx.currentQuery = $event);\n              return i0.ɵɵresetView($event);\n            });\n            i0.ɵɵlistener(\"keydown\", function ChatPanelComponent_Template_textarea_keydown_20_listener($event) {\n              i0.ɵɵrestoreView(_r1);\n              return i0.ɵɵresetView(ctx.onKeyPress($event));\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(22, \"button\", 20);\n            i0.ɵɵlistener(\"click\", function ChatPanelComponent_Template_button_click_22_listener() {\n              i0.ɵɵrestoreView(_r1);\n              return i0.ɵɵresetView(ctx.sendQuery());\n            });\n            i0.ɵɵtemplate(23, ChatPanelComponent__svg_svg_23_Template, 2, 0, \"svg\", 21)(24, ChatPanelComponent_div_24_Template, 1, 0, \"div\", 22);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(25, \"div\", 23)(26, \"div\", 24)(27, \"span\", 25);\n            i0.ɵɵtext(28, \"Press \");\n            i0.ɵɵelementStart(29, \"kbd\");\n            i0.ɵɵtext(30, \"Enter\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(31, \" to send, \");\n            i0.ɵɵelementStart(32, \"kbd\");\n            i0.ɵɵtext(33, \"Shift+Enter\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(34, \" for new line\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵtemplate(35, ChatPanelComponent_div_35_Template, 4, 3, \"div\", 26);\n            i0.ɵɵelementEnd()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(8);\n            i0.ɵɵproperty(\"disabled\", ctx.messages.length === 0);\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"disabled\", ctx.messages.length === 0);\n            i0.ɵɵadvance(3);\n            i0.ɵɵclassProp(\"empty\", ctx.messages.length === 0);\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"ngIf\", ctx.messages.length === 0);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.messages.length > 0);\n            i0.ɵɵadvance(3);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.currentQuery);\n            i0.ɵɵproperty(\"disabled\", ctx.isStreaming);\n            i0.ɵɵattribute(\"aria-label\", \"Ask a question about your documents\");\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"disabled\", !ctx.currentQuery.trim() || ctx.isStreaming);\n            i0.ɵɵattribute(\"aria-label\", \"Send message\");\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", !ctx.isStreaming);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.isStreaming);\n            i0.ɵɵadvance(11);\n            i0.ɵɵproperty(\"ngIf\", ctx.connectionStatus !== \"connected\");\n          }\n        },\n        dependencies: [CommonModule, i4.NgForOf, i4.NgIf, FormsModule, i5.DefaultValueAccessor, i5.NgControlStatus, i5.NgModel],\n        styles: [\".chat-panel[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;background:#fff}.chat-header[_ngcontent-%COMP%]{border-bottom:1px solid #e5e7eb;background:#f9fafb}.header-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1rem}.chat-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin:0;font-size:.875rem;font-weight:600;color:#111827}.header-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.header-btn[_ngcontent-%COMP%]{background:none;border:1px solid #d1d5db;color:#6b7280;padding:.375rem;border-radius:.375rem;cursor:pointer;transition:all .15s}.header-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#f3f4f6;border-color:#9ca3af}.header-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.messages-container[_ngcontent-%COMP%]{flex:1;overflow-y:auto}.messages-container.empty[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.welcome-state[_ngcontent-%COMP%]{text-align:center;padding:3rem 2rem;max-width:32rem;margin:0 auto}.welcome-icon[_ngcontent-%COMP%]{margin-bottom:1.5rem}.welcome-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#d1d5db}.welcome-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;color:#111827;margin:0 0 .5rem}.welcome-description[_ngcontent-%COMP%]{color:#6b7280;margin:0 0 2rem;line-height:1.5}.examples-title[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#374151;margin:0 0 1rem}.examples-grid[_ngcontent-%COMP%]{display:grid;gap:.5rem}.example-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.75rem;background:#fff;border:1px solid #e5e7eb;border-radius:.5rem;text-align:left;font-size:.875rem;color:#374151;cursor:pointer;transition:all .15s}.example-btn[_ngcontent-%COMP%]:hover{background:#f9fafb;border-color:#d1d5db}.example-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#9ca3af;flex-shrink:0}.messages-list[_ngcontent-%COMP%]{padding:1rem}.message-wrapper[_ngcontent-%COMP%]{margin-bottom:1.5rem}.message-wrapper[_ngcontent-%COMP%]:last-child{margin-bottom:0}.user-message[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.75rem}.user-message[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]{background:#111827;color:#fff;border-radius:1rem 1rem .25rem;padding:.75rem 1rem;max-width:70%}.user-message[_ngcontent-%COMP%]   .message-avatar[_ngcontent-%COMP%]{order:2;flex-shrink:0;width:2rem;height:2rem;background:#f3f4f6;border-radius:50%;display:flex;align-items:center;justify-content:center}.user-message[_ngcontent-%COMP%]   .message-avatar[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#6b7280}.assistant-message[_ngcontent-%COMP%]{display:flex;gap:.75rem}.assistant-message[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]{background:#f9fafb;border:1px solid #e5e7eb;border-radius:1rem 1rem 1rem .25rem;padding:1rem;flex:1;max-width:70%}.assistant-message[_ngcontent-%COMP%]   .message-avatar[_ngcontent-%COMP%]{flex-shrink:0;width:2rem;height:2rem;background:#111827;color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center}.message-content[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.5;margin:0}.message-timestamp[_ngcontent-%COMP%]{font-size:.75rem;color:#ffffffb3;margin-top:.5rem}.assistant-message[_ngcontent-%COMP%]   .message-timestamp[_ngcontent-%COMP%]{color:#9ca3af}.no-answer-state[_ngcontent-%COMP%]{display:flex;gap:1rem;padding:1rem;background:#fef3c7;border:1px solid #fbbf24;border-radius:.5rem}.no-answer-icon[_ngcontent-%COMP%]{flex-shrink:0}.no-answer-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#d97706}.no-answer-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:.875rem;font-weight:600;color:#92400e}.no-answer-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.875rem;color:#b45309}.answer-text[_ngcontent-%COMP%]{margin-bottom:1rem}.answer-text[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:600}.answer-text[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{font-style:italic}.answer-text[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background:#f3f4f6;padding:.125rem .25rem;border-radius:.25rem;font-family:monospace;font-size:.8125rem}.message-sources[_ngcontent-%COMP%]{margin-top:1rem;padding-top:1rem;border-top:1px solid #e5e7eb}.sources-title[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;color:#374151;margin:0 0 .5rem}.sources-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.source-citation[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:.5rem;background:#fff;border:1px solid #e5e7eb;border-radius:.375rem;cursor:pointer;transition:all .15s;text-align:left}.source-citation[_ngcontent-%COMP%]:hover{background:#f9fafb;border-color:#d1d5db}.source-citation.confidence-high[_ngcontent-%COMP%]{border-left:3px solid #16a34a}.source-citation.confidence-medium[_ngcontent-%COMP%]{border-left:3px solid #d97706}.source-citation.confidence-low[_ngcontent-%COMP%]{border-left:3px solid #dc2626}.citation-content[_ngcontent-%COMP%]{flex:1}.citation-title[_ngcontent-%COMP%]{display:block;font-size:.875rem;font-weight:500;color:#111827;margin-bottom:.25rem}.citation-location[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280}.citation-confidence[_ngcontent-%COMP%]{font-size:.75rem;font-weight:500;color:#9ca3af}.message-footer[_ngcontent-%COMP%]{margin-top:1rem;padding-top:.75rem;border-top:1px solid #f3f4f6}.message-meta[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:.5rem}.processing-time[_ngcontent-%COMP%]{font-size:.75rem;color:#9ca3af}.confidence-bar[_ngcontent-%COMP%]{position:relative;height:.25rem;background:#f3f4f6;border-radius:.125rem;margin-bottom:.75rem;overflow:hidden}.confidence-fill[_ngcontent-%COMP%]{height:100%;border-radius:.125rem;transition:width .3s ease}.confidence-high[_ngcontent-%COMP%]   .confidence-fill[_ngcontent-%COMP%]{background:#16a34a}.confidence-medium[_ngcontent-%COMP%]   .confidence-fill[_ngcontent-%COMP%]{background:#d97706}.confidence-low[_ngcontent-%COMP%]   .confidence-fill[_ngcontent-%COMP%]{background:#dc2626}.confidence-label[_ngcontent-%COMP%]{position:absolute;right:0;top:-1.5rem;font-size:.75rem;color:#6b7280}.message-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.action-btn[_ngcontent-%COMP%]{background:none;border:1px solid #e5e7eb;color:#6b7280;padding:.375rem;border-radius:.375rem;cursor:pointer;transition:all .15s}.action-btn[_ngcontent-%COMP%]:hover{background:#f9fafb;border-color:#d1d5db}.streaming-indicator[_ngcontent-%COMP%]{display:flex;gap:.75rem;padding:0 1rem 1rem}.streaming-bubble[_ngcontent-%COMP%]{background:#f9fafb;border:1px solid #e5e7eb;border-radius:1rem 1rem 1rem .25rem;padding:1rem}.streaming-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.typing-dots[_ngcontent-%COMP%]{display:flex;gap:.25rem}.typing-dots[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:.375rem;height:.375rem;background:#9ca3af;border-radius:50%;animation:_ngcontent-%COMP%_typing 1.4s infinite ease-in-out}.typing-dots[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(1){animation-delay:-.32s}.typing-dots[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){animation-delay:-.16s}@keyframes _ngcontent-%COMP%_typing{0%,80%,to{transform:scale(.8);opacity:.5}40%{transform:scale(1);opacity:1}}.streaming-text[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280}.input-area[_ngcontent-%COMP%]{border-top:1px solid #e5e7eb;background:#fff;padding:1rem}.input-container[_ngcontent-%COMP%]{display:flex;gap:.75rem;align-items:flex-end}.query-input[_ngcontent-%COMP%]{flex:1;min-height:2.5rem;max-height:8rem;padding:.75rem;border:1px solid #d1d5db;border-radius:.75rem;font-size:.875rem;line-height:1.4;resize:none}.query-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#111827;box-shadow:0 0 0 1px #111827}.query-input[_ngcontent-%COMP%]:disabled{background:#f9fafb;color:#9ca3af;cursor:not-allowed}.send-btn[_ngcontent-%COMP%]{flex-shrink:0;width:2.5rem;height:2.5rem;background:#111827;color:#fff;border:none;border-radius:.75rem;cursor:pointer;transition:all .15s;display:flex;align-items:center;justify-content:center}.send-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#374151}.send-btn[_ngcontent-%COMP%]:disabled{background:#d1d5db;cursor:not-allowed}.loading-spinner[_ngcontent-%COMP%]{width:1rem;height:1rem;border:2px solid rgba(255,255,255,.3);border-top:2px solid white;border-radius:50%;animation:spin 1s linear infinite}.input-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-top:.75rem}.input-hints[_ngcontent-%COMP%]{font-size:.75rem;color:#9ca3af}.input-hints[_ngcontent-%COMP%]   kbd[_ngcontent-%COMP%]{background:#f3f4f6;border:1px solid #d1d5db;border-radius:.25rem;padding:.125rem .25rem;font-family:monospace;font-size:.6875rem}.input-status[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:.75rem}.status-indicator[_ngcontent-%COMP%]{width:.5rem;height:.5rem;border-radius:50%}.status-indicator.status-connected[_ngcontent-%COMP%]{background:#16a34a}.status-indicator.status-connecting[_ngcontent-%COMP%]{background:#d97706;animation:_ngcontent-%COMP%_pulse 2s infinite}.status-indicator.status-disconnected[_ngcontent-%COMP%]{background:#dc2626}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}.status-text[_ngcontent-%COMP%]{color:#6b7280}@media (max-width: 768px){.welcome-state[_ngcontent-%COMP%]{padding:2rem 1rem}.messages-list[_ngcontent-%COMP%]{padding:.75rem}.message-bubble[_ngcontent-%COMP%]{max-width:85%!important}.input-area[_ngcontent-%COMP%]{padding:.75rem}.input-footer[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:.5rem}}\"]\n      });\n    }\n  }\n  return ChatPanelComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}